<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Processing...</title>
    <style>
        * { box-sizing: border-box; }

        body { 
            background-color: #000; 
            color: #fff; 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            height: 100vh; 
            margin: 0; 
            overflow: hidden;
        }

        /* --- TRUCK SCENE CONTAINER --- */
        .scene {
            position: relative;
            width: 100%;
            max-width: 600px;
            height: 240px;
            background: #000;
            overflow: hidden;
            /* Removed bottom margin since there is no text below anymore */
            opacity: 0;
            animation: fadeIn 0.8s ease-out forwards;
        }

        /* --- ROAD --- */
        .road {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 80px; 
            background-color: #111;
            border-top: 1px solid #333;
            z-index: 1;
        }

        .stripe-container {
            position: absolute;
            top: 35px;
            width: 200%;
            height: 8px;
            display: flex;
            animation: moveRoad 0.5s linear infinite;
        }

        .stripe {
            width: 100px;
            height: 100%;
            background-color: #333;
            margin-right: 150px;
            border-radius: 2px;
        }

        /* --- TRUCK --- */
        .truck-wrapper {
            position: absolute;
            bottom: 80px;
            left: 50%;
            transform: translate(-50%, 15px); 
            width: 200px;
            height: auto;
            z-index: 10;
        }

        .truck-body-group { animation: bounce 0.6s ease-in-out infinite alternate; }
        .wheel-group { 
            transform-box: fill-box; 
            transform-origin: center; 
            animation: spin 0.25s linear infinite; 
        }

        /* --- WIND --- */
        .wind-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 5;
        }

        .wind-line {
            position: absolute;
            background: rgba(255, 255, 255, 0.1);
            height: 1px;
            border-radius: 1px;
        }

        /* --- KEYFRAMES --- */
        @keyframes moveRoad {
            0% { transform: translateX(0); }
            100% { transform: translateX(-250px); } 
        }
        @keyframes spin { 100% { transform: rotate(360deg); } }
        @keyframes bounce { 
            0% { transform: translateY(0); } 
            100% { transform: translateY(3px); } 
        }
        @keyframes fadeIn { to { opacity: 1; } }
    </style>
</head>
<body>

    <!-- TRUCK SCENE -->
    <div class="scene">
        <div class="wind-container" id="windContainer"></div>

        <div class="truck-wrapper">
            <svg viewBox="0 0 260 140" xmlns="http://www.w3.org/2000/svg">
                <!-- Chassis -->
                <g id="chassis">
                    <rect x="35" y="100" width="65" height="10" fill="#111" />
                    <rect x="210" y="100" width="20" height="10" fill="#111" />
                </g>
                <!-- Body -->
                <g class="truck-body-group">
                    <rect x="10" y="10" width="170" height="90" rx="4" fill="#222" stroke="#444" stroke-width="2"/>
                    <rect x="180" y="70" width="15" height="10" fill="#333"/>
                    <path d="M 195 90 L 195 40 L 220 40 L 240 60 L 240 90 L 250 90 L 250 105 L 195 105" fill="#151515" stroke="#333" stroke-width="2"/>
                    <path d="M 200 45 L 215 45 L 235 65 L 235 80 L 200 80 Z" fill="#666"/>
                    <rect x="240" y="95" width="5" height="8" fill="#fff"/>
                    <path d="M 245 99 L 480 60 L 480 140 Z" fill="url(#lightBeam)" opacity="0.2"/>
                    <rect x="185" y="20" width="6" height="60" fill="#333"/>
                    <path d="M 185 20 L 178 15" stroke="#333" stroke-width="3"/>
                </g>
                <!-- Wheels -->
                <g class="wheel-group"><circle cx="45" cy="110" r="18" fill="#000" stroke="#333" stroke-width="2"/><circle cx="45" cy="110" r="8" fill="#555"/><rect x="43" y="94" width="4" height="32" fill="#333" rx="1"/><rect x="29" y="108" width="32" height="4" fill="#333" rx="1"/></g>
                <g class="wheel-group"><circle cx="90" cy="110" r="18" fill="#000" stroke="#333" stroke-width="2"/><circle cx="90" cy="110" r="8" fill="#555"/><rect x="88" y="94" width="4" height="32" fill="#333" rx="1"/><rect x="74" y="108" width="32" height="4" fill="#333" rx="1"/></g>
                <g class="wheel-group"><circle cx="220" cy="110" r="18" fill="#000" stroke="#333" stroke-width="2"/><circle cx="220" cy="110" r="8" fill="#555"/><rect x="218" y="94" width="4" height="32" fill="#333" rx="1"/><rect x="204" y="108" width="32" height="4" fill="#333" rx="1"/></g>
                <defs><linearGradient id="lightBeam" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" style="stop-color:rgb(255, 255, 255);stop-opacity:0.4" /><stop offset="100%" style="stop-color:rgb(255, 255, 255);stop-opacity:0" /></linearGradient></defs>
            </svg>
        </div>

        <div class="road">
            <div class="stripe-container">
                <div class="stripe"></div>
                <div class="stripe"></div>
                <div class="stripe"></div>
                <div class="stripe"></div>
            </div>
        </div>
    </div>

    <script>
        // --- 1. WIND ANIMATION SCRIPT ---
        function createWindLine() {
            const container = document.getElementById('windContainer');
            if(!container) return;
            
            const line = document.createElement('div');
            line.classList.add('wind-line');

            const randomTop = 10 + Math.random() * 60; 
            const randomWidth = 40 + Math.random() * 120;
            const randomDuration = 0.2 + Math.random() * 0.3;

            line.style.top = randomTop + '%';
            line.style.width = randomWidth + 'px';
            line.style.right = '-150px'; 
            
            const animation = line.animate([
                { transform: 'translateX(0)', opacity: 0 },
                { transform: 'translateX(-100px)', opacity: 0.3, offset: 0.1 },
                { transform: `translateX(-${window.innerWidth + 200}px)`, opacity: 0 }
            ], {
                duration: randomDuration * 1000,
                easing: 'linear'
            });

            container.appendChild(line);
            animation.onfinish = () => line.remove();
        }

        // Start wind immediately
        setInterval(createWindLine, 50);

        // --- 2. MAIN REDIRECT LOGIC ---
        
        // Notify the main tab if accessible
        try {
            if (window.opener) {
                window.opener.postMessage("PAYMENT_SUCCESS", "*");
            }
        } catch (e) { console.log("Main tab not accessible"); }

        // Close automatically
        setTimeout(() => {
            window.close();
        }, 2500);
    </script>
</body>
</html>